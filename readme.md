
The codes presented in this repository correspond to the work developed in 

**Virtual Representation of Fresh Produce Washing in 4.0 Industry: Modelling and
Calibration through optimal experimental design**

---

### Requirements

The script presented here are built in the Matlab environment. Additionally, the AMIGO2 toolbox has been used to perform optimization and optimal experimental design. It can be downloaded from [](sites.google.com/site/amigo2toolbox), and it should be placed in the same location that contains the repository files ( see *About the Repository* ). 

### User guide

Each script starting with the prefix *Run_sec*[*tag*] is related to a study section of the work article submitted with this code whereas *PE* stands for *Parameter Estimation* . The *tag* correspondence is stated as follows :

​	[ sec311 ] Water contamination and dilution rates in the industry,

​	[ sec312 ] Inactivation rates in chlorine-based sanitation,

​	[ sec313 ] Free chlorine dynamics,

​	[ sec320 ] Optimal experimental design to estimate unknown model parameters in the industry.

Hence, to reproduce the desired study, the user only needs to run the corresponding *Run_sec*[*tag*] script. An additional script that handles all studies called 'RUN_ALL.m' has been included to perform all studies from one call.

The results and plots obtained from each study can be found in the *Results* folder inside the repository directory (see *About the Repository*). A subfolder within *Results* is created to store the results of each study separately, these subfolders could be identified by the sec[*tag*] identifier.

### About the Repository 

├── <span style="color:blue">[Not in Repository] </span> Folder: AMIGO2_[version]           <span style="color:grey">Place Here the AMIGO2 toolbox folder</span>

├── Folder: AMIGO_changes						<span style="color:grey"> </span> <span style="color:grey">Changes of AMIGO2 toolbox </span>

├── Folder: Exp_data     						<span style="color:grey"> </span>	 <span style="color:grey">Experimental data and preprocessing scripts</span>	

├── Folder: OED_codes							   <span style="color:grey">Scripts required to perform OED study </span>	

├── Folder: Pre_optims							   <span style="color:grey">Previously computed optims</span>	

├── Folder: Results							          <span style="color:grey">Saved results location</span>	

├── Script:  RUN_ALL.m						          <span style="color:grey">Script to perform all parameter estimations</span>	

├── Script:  Run_sec311_PE_contamination.m  		 <span style="color:grey">Script to perform PE for: Water Contamination... </span>

├── Script:  Run_sec312_PE_inactivation.m			<span style="color:grey">Script to perform PE for: Inactivation rates ... </span>

├── Script:  Run_sec313_PE_Beta_and_Gamma.m	    <span style="color:grey">Script to perform PE for: Free Chlorine dynamics ...</span>

├── Script:  Run_sec320_OED.m                                           <span style="color:grey">Script to perform Optimal experimental design ...</span>

├── File: LICENSE  

└── File: readme.md     					                  <span style="color:grey">This file</span>

### Notes

- The *AMIGO_changes* folder include changes of AMIGO2 toolbox to:
  
  - allow the use of error_data always (even for OED)
  
  - enable multi-experiment estimation with more than 20 experiments

- Exp_data includes experimental data of industrial washing processes

- Pre_optims includes the best solutions for each of the problems. As some optimisations take hours and many tests of computations, we start from current this optimum. Nevertheless, the complete optimisation can be performed by the user if desired.

- Results folder includes the results generated by the code

- WARNING: In case the user decide to use a different version of AMIGO2, the call to the toolbox in any Run_sec[..] code must be modified. 

  ​	Example: To run the 2025 version, the folder must be placed following the repository scheme, and 	the proper call codeline is: AMIGO2_2025 run AMIGO2_R2025/AMIGO_Startup.m

---

### Contact

- miriamr@iim.csic.es	
